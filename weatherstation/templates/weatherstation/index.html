{% extends "weatherstation/base.html" %}
{% load humanize %}
{% block content %}

<!-- ==================================================================================================================== -->
<!-- ======================================== Head Above Google Maps ==================================================== -->
<!-- ==================================================================================================================== -->

<!-- Content Header (Page header) -->
{% regroup stationlogs|dictsort:"station_id" by station_id as station_list %}
{% for station in station_list %}
{% for log in station.list %}
{% if forloop.last %}





{% endif %}
{% endfor %}
{% endfor %}

<!-- /.content-header -->


<!-- ================================================================================================================== -->
<!-- =========================================== Main Content ========================================================= -->
<!-- ================================================================================================================== -->

<section class="content" style="font-family: Arial, Helvetica, sans-serif">
  <div class="container-fluid">


    <!-- ============================================================================================================ -->
    <!-- ===================================== Google Maps ========================================================== -->
    <!-- ============================================================================================================ -->

    <!--  Google Maps -->
    <div class="row" style="margin-top:10px;">
      <div class="col-xl-12 col-lg-7">
        <div id="map"></div>
      </div>
    </div>


    <!-- Small boxes (Stat box) -->
    <p></p>

    <!-- ============================================================================================================ -->
    <!-- ================================== Start of Station 1 ====================================================== -->
    <!-- ================================= Data Information Label =================================================== -->
    <!-- ============================================================================================================ -->

    <div class="station1">

    <!-- Regroup by station_id -->
    {% regroup stationlogs|dictsort:"station_id" by station_id as station_list %}
    <!-- Loop by station_id -->
    {% for station in station_list %}
    <!-- Select station_id -->
    {% if station.grouper == 1 %}
    <!-- Loop all logs in station_id -->
    {% for log in station.list %}
    <!-- Select only the last value -->
    {% if forloop.last %}

    <!-- Head Label -->
    <div class="station" id="head_station1" style="display:flex; margin-bottom:10px;">
      <div class="col-sm-12">
        <h5 class="m-0" style="float: left;">Station {{ log.station_id }}</h5>
        <h8 style="float: right;">Last Updated : &nbsp;{{ log.station_recorded_time|naturaltime }}</h8>
      </div>
    </div><!-- /.row -->


    <div class="row">

      <!-- Temperature -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="fas fa-thermometer-half"></i></span>
          <div class="info-box-content">
            <h4 style="color: #00B743;"><strong>Temperature</strong></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_temperature|floatformat:1  }}
              <p style="display:inline;font-size:22px;">°C</p>
            </span>
          </div>
        </div>
      </div>

      <!-- Humidity -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-info"><i class="fas fa-tint"></i></span>
          <div class="info-box-content">
            <h4 style="color: #00A3BA;"><strong>Humidity</strong></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_humidity|floatformat:1 }}
              <p style="display:inline;font-size:22px;">%</p>
            </span>
          </div>
        </div>
      </div>

      <!-- PM 2.5 -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-secondary"><i class="fab fa-first-order-alt fa-2x"></i></span>
          <div class="info-box-content">
            <h4 style="color: #6B747D;"><strong>PM <sub>2.5</sub></strong><i id="pm-tooltip" style="float:right;" class="fas fa-info-circle pm25-tooltip" data-toggle="tooltip" data-placement="right"></i></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_pm25 }}
              <p style="display:inline;font-size:16px;">µg./m<sup>3</sup></p>
            </span>
          </div>
        </div>
      </div>

      <!-- PM 10 -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-secondary"><i class="fab fa-first-order-alt fa-2x"></i></span>
          <div class="info-box-content">
            <h4 style="color: #6B747D;"><strong>PM <sub>10</sub></strong><i style="float:right;" class="fas fa-info-circle pm10-tooltip" data-toggle="tooltip" data-placement="right"></i></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_pm10 }}
              <p style="display:inline;font-size:16px;">µg./m<sup>3</sup></p>
            </span>
          </div>
        </div>
      </div>
    </div>

    {% endif %}
    {% endfor %}
    {% endif %}
    {% endfor %}

    </div>

    <!-- ============================================================================================================ -->
    <!-- ================================= Grafana graphs =========================================================== -->
    <!-- ============================================================================================================ -->

    <div class="station1">

    <!-- Row of Grafana graphs -->
    <div class="row">

      <!-- Temperature -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-primary shadow h-100 py-2">
          <iframe id="graph_station1_temperature" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=2" frameborder="4"></iframe>
        </div>
      </div>

      <!-- Humidity -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-success shadow h-100 py-2">
          <iframe id="graph_station1_humidity" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=4" frameborder="4"></iframe>
        </div>
      </div>

    </div>

    <div class="row">

      <!-- PM 2.5 -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-danger shadow h-100 py-2">
          <iframe id="graph_station1_pm25" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=6" frameborder="4"></iframe>
        </div>
      </div>

      <!-- PM 10 -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-danger shadow h-100 py-2">
          <iframe id="graph_station1_pm10" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=26" frameborder="4"></iframe>
        </div>
      </div>

    </div>

    </div>

    <!-- ============================================================================================================ -->
    <!-- ================================= End of Station 1 ========================================================= -->
    <!-- ============================================================================================================ -->

    <!-- ============================================================================================================ -->
    <!-- ================================== Start of Station 2 ====================================================== -->
    <!-- ================================= Data Information Label =================================================== -->
    <!-- ============================================================================================================ -->

    <div class="station2">

    <!-- Regroup by station_id -->
    {% regroup stationlogs|dictsort:"station_id" by station_id as station_list %}
    <!-- Loop by station_id -->
    {% for station in station_list %}
    <!-- Select station_id -->
    {% if station.grouper == 2 %}
    <!-- Loop all logs in station_id -->
    {% for log in station.list %}
    <!-- Select only the last value -->
    {% if forloop.last %}

    <!-- Head Label -->
    <div class="station" id="head_station1" style="display:flex; margin-bottom:10px;">
      <div class="col-sm-12">
        <h5 class="m-0" style="float: left;">Station {{ log.station_id }}</h5>
        <h8 style="float: right;">Last Updated : &nbsp;{{ log.station_recorded_time|naturaltime }}</h8>
      </div>
    </div><!-- /.row -->


    <div class="row">

      <!-- Temperature -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-success"><i class="fas fa-thermometer-half"></i></span>
          <div class="info-box-content">
            <h4 style="color: #00B743;"><strong>Temperature</strong></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_temperature|floatformat:1 }}
              <p style="display:inline;font-size:22px;">°C</p>
            </span>
          </div>
        </div>
      </div>

      <!-- Humidity -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-info"><i class="fas fa-tint"></i></span>
          <div class="info-box-content">
            <h4 style="color: #00A3BA;"><strong>Humidity</strong></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_humidity|floatformat:1 }}
              <p style="display:inline;font-size:22px;">%</p>
            </span>
          </div>
        </div>
      </div>

      <!-- PM 2.5 -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-secondary"><i class="fab fa-first-order-alt fa-2x"></i></span>
          <div class="info-box-content">
            <h4 style="color: #6B747D;"><strong>PM <sub>2.5</sub></strong><i style="float:right;" class="fas fa-info-circle pm25-tooltip" data-toggle="tooltip" data-placement="right"></i></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_pm25 }}
              <p style="display:inline;font-size:16px;">µg./m<sup>3</sup></p>
            </span>
          </div>
        </div>
      </div>

      <!-- PM 10 -->
      <div class="col-lg-3 col-12">
        <div class="info-box">
          <span class="info-box-icon bg-secondary"><i class="fab fa-first-order-alt fa-2x"></i></span>
          <div class="info-box-content">
            <h4 style="color: #6B747D;"><strong>PM <sub>10</sub></strong><i style="float:right;" class="fas fa-info-circle pm10-tooltip" data-toggle="tooltip" data-placement="right"></i></h4>
            <span class="info-box-number" style="font-size:25px;">{{ log.station_pm10 }}
              <p style="display:inline;font-size:16px;">µg./m<sup>3</sup></p>
            </span>
          </div>
        </div>
      </div>
    </div>

    {% endif %}
    {% endfor %}
    {% endif %}
    {% endfor %}

    </div>

    <!-- ============================================================================================================ -->
    <!-- ================================= Grafana graphs =========================================================== -->
    <!-- ============================================================================================================ -->

    <div class="station2">

    <!-- Row of Grafana graphs -->
    <div class="row">

      <!-- Temperature -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-primary shadow h-100 py-2">
          <iframe id="graph_station2_temperature" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=35" frameborder="4"></iframe>
        </div>
      </div>

      <!-- Humidity -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-success shadow h-100 py-2">
          <iframe id="graph_station2_humidity" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=36" frameborder="4"></iframe>
        </div>
      </div>

    </div>

    <div class="row">

      <!-- PM 2.5 -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-danger shadow h-100 py-2">
          <iframe id="graph_station2_pm25" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=37" frameborder="4"></iframe>
        </div>
      </div>

      <!-- PM 10 -->
      <div class="col-xs col-md-6" style="margin-top:10px;">
        <div class="card border-left-danger shadow h-100 py-2">
          <iframe id="graph_station2_pm10" src="http://188.166.180.188:3000/d-solo/4wv0ENHGz/air-quality-monitoring-system?orgId=1&refresh=5s&panelId=38" frameborder="4"></iframe>
        </div>
      </div>

    </div>

    </div>

    <!-- ============================================================================================================ -->
    <!-- ================================= End of Station 1 ========================================================= -->
    <!-- ============================================================================================================ -->

  </div><!-- /.container-fluid -->
</section>
{% endblock content %}
